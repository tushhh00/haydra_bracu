###############################################
# MoveIt Servo Configuration for 4-DOF Arm
# Optimized for butter-smooth control
###############################################

servo:
  # Robot config
  move_group_name: manipulator
  planning_frame: base_link
  ee_frame: end_effector_link
  robot_link_command_frame: base_link
  
  # Publish rate (higher = smoother, 50-100Hz typical)
  publish_period: 0.02  # 50Hz
  
  # Scale factors for smooth control (LOWER = SMOOTHER)
  scale:
    linear: 0.2       # m/s - slower for precision
    rotational: 0.4   # rad/s
    joint: 0.4        # joint velocity scale
  
  # Incoming command settings
  command_in_type: "unitless"  # joystick-like [-1, 1] input
  cartesian_command_in_topic: ~/delta_twist_cmds
  joint_command_in_topic: ~/delta_joint_cmds
  
  # Command timeout
  incoming_command_timeout: 0.2
  
  # Smoothing (KEY for butter-smooth control!)
  # Lower coefficient = more smoothing but more lag
  smoothing_filter_plugin_name: "online_signal_smoothing::ButterworthFilterPlugin"
  
  # Butterworth filter settings
  butterworth_filter_order: 2
  butterworth_filter_cutoff_frequency: 5.0  # Hz - lower = smoother
  
  # Joint limits
  override_velocity_scaling_factor: 0.0  # Use joint limits
  
  # Collision checking
  check_collisions: true
  collision_check_rate: 10.0
  self_collision_proximity_threshold: 0.01
  scene_collision_proximity_threshold: 0.02
  
  # Singularity handling
  lower_singularity_threshold: 17.0
  hard_stop_singularity_threshold: 30.0
  leaving_singularity_threshold_multiplier: 2.0
  
  # Halt settings  
  halt_all_joints_in_cartesian_mode: true
  halt_all_joints_in_joint_mode: true
  
  # Status
  status_topic: ~/status

